<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Glenn Davis" />

<meta name="date" content="2019-05-30" />

<title>Phenol Red - pH Indicator</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Phenol Red - pH Indicator</h1>
<h4 class="author">Glenn Davis</h4>
<h4 class="date">2019-05-30</h4>


<div id="TOC">
<ul>
<li><a href="#absorbance-spectra-at-different-ph-values">Absorbance Spectra at Different pH Values</a></li>
<li><a href="#absorbance-at-selected-wavelengths">Absorbance at Selected Wavelengths</a></li>
<li><a href="#interpolation-from-ph6.8-to-ph8.2">Interpolation from pH=6.8 to pH=8.2</a></li>
<li><a href="#references">References</a></li>
<li><a href="#session-information">Session Information</a></li>
</ul>
</div>

<p>Phenol red is an indicator commonly used to measure pH in swimming pool test kits, see e.g. <span class="citation">[2]</span>. The goal of this <strong>colorSpec</strong> vignette is to reproduce the colors seen in such a test kit, for typical values of pool pH. Calculations like this one might make a good project for a college freshman chemistry class. Featured functions in this vignette are: <code>interpolate()</code> and <code>calibrate()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>( colorSpec )
<span class="kw">library</span>( spacesRGB )    <span class="co"># for functions plotPatchesRGB() and SignalRGBfromLinearRGB()</span></code></pre></div>
<p><br></p>
<div id="absorbance-spectra-at-different-ph-values" class="section level2">
<h2>Absorbance Spectra at Different pH Values</h2>
<p>The absorbance data for phenol red has already been digitized from <span class="citation">[1]</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path =<span class="st"> </span><span class="kw">system.file</span>( <span class="st">&quot;extdata/stains/PhenolRed-Fig7.txt&quot;</span>, <span class="dt">package=</span><span class="st">&quot;colorSpec&quot;</span> )
wave =<span class="st"> </span><span class="dv">350</span><span class="op">:</span><span class="dv">650</span>
phenolred =<span class="st"> </span><span class="kw">readSpectra</span>( path, <span class="dt">wavelength=</span>wave )</code></pre></div>
<pre><code>## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values

## Warning in regularize.values(x, y, ties, missing(ties)): collapsing to
## unique 'x' values</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>( <span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>) )
<span class="kw">plot</span>( phenolred, <span class="dt">main=</span><span class="st">'Absorbance Spectra of Phenol Red at Different pH Values'</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Compare this plot with <span class="citation">[1]</span>, Fig. 7. Unfortunately, the concentration and optical path length are unknown, but these curves can still be used as ‘relative absorbance’.</p>
<p><br></p>
</div>
<div id="absorbance-at-selected-wavelengths" class="section level2">
<h2>Absorbance at Selected Wavelengths</h2>
<p>We investigate how absorbance depends on pH for a few selected wavelengths.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wavesel =<span class="st"> </span><span class="kw">c</span>( <span class="dv">365</span>, <span class="dv">430</span>, <span class="dv">477</span>, <span class="dv">520</span>, <span class="dv">560</span>, <span class="dv">590</span> )  <span class="co"># 365 and 477 are 'isosbestic points'</span>
mat =<span class="st"> </span><span class="kw">apply</span>( <span class="kw">as.matrix</span>(wavesel), <span class="dv">1</span>, <span class="cf">function</span>( lambda ) { <span class="kw">as.numeric</span>(lambda <span class="op">==</span><span class="st"> </span>wave) } )
<span class="kw">colnames</span>( mat ) =<span class="st"> </span><span class="kw">sprintf</span>( <span class="st">&quot;%g nm&quot;</span>, wavesel )
mono =<span class="st"> </span><span class="kw">colorSpec</span>( mat, <span class="dt">wavelength=</span>wave, <span class="dt">quantity=</span><span class="st">'power'</span> )
RGB =<span class="st"> </span><span class="kw">product</span>( mono, BT.<span class="fl">709.</span>RGB, <span class="dt">wavelength=</span>wave )  <span class="co"># this is *linear* RGB</span>
colvec =<span class="st"> </span>grDevices<span class="op">::</span><span class="kw">rgb</span>( <span class="kw">SignalRGBfromLinearRGB</span>( RGB<span class="op">/</span><span class="kw">max</span>(RGB), <span class="dt">which=</span><span class="st">'scene'</span> )<span class="op">$</span>RGB )

phenolsel =<span class="st"> </span><span class="kw">resample</span>( phenolred, wavesel )
pH =<span class="st"> </span><span class="kw">as.numeric</span>( <span class="kw">sub</span>( <span class="st">'[^0-9]*([0-9]+)$'</span>, <span class="st">'</span><span class="ch">\\</span><span class="st">1'</span>, <span class="kw">specnames</span>(phenolred) ) )
pHvec =<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(pH),<span class="kw">max</span>(pH),<span class="dt">by=</span><span class="fl">0.05</span>)
phenolsel =<span class="st"> </span><span class="kw">interpolate</span>( phenolsel, pH, pHvec )
mat =<span class="st"> </span><span class="kw">t</span>( <span class="kw">as.matrix</span>( phenolsel ) )
<span class="kw">par</span>( <span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">0.6</span>,<span class="fl">0.4</span>) )
<span class="kw">plot</span>( <span class="kw">range</span>(pH), <span class="kw">range</span>(mat), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">'pH'</span>, <span class="dt">ylab=</span><span class="st">'absorbance'</span>, <span class="dt">type=</span><span class="st">'n'</span> )
<span class="kw">grid</span>( <span class="dt">lty=</span><span class="dv">1</span> ) ; <span class="kw">abline</span>( <span class="dt">h=</span><span class="dv">0</span> )
<span class="kw">matlines</span>( pHvec, mat, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span>colvec, <span class="dt">lty=</span><span class="dv">1</span> )
<span class="kw">title</span>( <span class="st">&quot;Absorbance of Phenol Red at Selected Wavelengths&quot;</span>)
<span class="kw">legend</span>( <span class="st">'topleft'</span>, <span class="kw">specnames</span>(mono), <span class="dt">col=</span>colvec, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">bty=</span><span class="st">'n'</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br></p>
<p>Note that the curves for the isosbestic points 365 and 477 nm are approximately flat, as expected. But for 430 nm the curve is distinctly non-monotone. This indicates that the solution is not truly a mixture of the acidic and basic species (especially for pH <span class="math inline">\(\le\)</span> 6), and there may be an undesired side reaction, see <span class="citation">[3]</span>.</p>
<p><br></p>
</div>
<div id="interpolation-from-ph6.8-to-ph8.2" class="section level2">
<h2>Interpolation from pH=6.8 to pH=8.2</h2>
<p>Swimming pools should be slightly basic; a standard test kit covers the range from pH=6.8 to pH=8.2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pHvec =<span class="st"> </span><span class="kw">seq</span>(<span class="fl">6.8</span>,<span class="fl">8.2</span>,<span class="dt">by=</span><span class="fl">0.2</span>)
phenolpool =<span class="st"> </span><span class="kw">interpolate</span>( phenolred, pH, pHvec )
<span class="kw">par</span>( <span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>) )
<span class="kw">plot</span>( phenolpool, <span class="dt">main=</span><span class="st">&quot;Absorbance Spectra of Phenol Red at Swimming Pool pH Values&quot;</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The rest of this section is best viewed on a display calibrated for sRGB, see <span class="citation">[4]</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create an uncalibrated 'material responder'</span>
testkit =<span class="st"> </span><span class="kw">product</span>( D65.1nm, <span class="st">'solution'</span>, BT.<span class="fl">709.</span>RGB, <span class="dt">wave=</span>wave )
<span class="co"># now calibrate so that fully transparent pure water has response RGB=c(1,1,1)</span>
testkit =<span class="st"> </span><span class="kw">calibrate</span>( testkit, <span class="dt">response=</span><span class="dv">1</span> )
RGB =<span class="st"> </span><span class="kw">product</span>( phenolpool, testkit )
RGB</code></pre></div>
<pre><code>##                R         G         B
## pH=6.8 1.0282473 0.6840105 0.2260205
## pH=7   1.0237233 0.5938036 0.2506686
## pH=7.2 1.0182971 0.4961330 0.2788955
## pH=7.4 1.0124869 0.4022827 0.3100400
## pH=7.6 1.0067433 0.3195781 0.3440245
## pH=7.8 1.0014227 0.2505541 0.3812950
## pH=8   0.9969035 0.1947707 0.4225796
## pH=8.2 0.9935212 0.1503867 0.4683717</code></pre>
<p>Unfortunately, in some cases the red value is greater than 1 (G and B are OK). The color is outside the sRGB gamut. Start over and recalibrate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">testkit =<span class="st"> </span><span class="kw">product</span>( D65.1nm, <span class="st">'solution'</span>, BT.<span class="fl">709.</span>RGB, <span class="dt">wave=</span>wave )
<span class="co"># recalibrate, but lower the background a little, to allow more 'headroom' for indicator colors</span>
bglin =<span class="st"> </span><span class="fl">0.96</span>  <span class="co">#  graylevel for the background, linear</span>
testkit =<span class="st"> </span><span class="kw">calibrate</span>( testkit, <span class="dt">response=</span>bglin )
RGB =<span class="st"> </span><span class="kw">product</span>( phenolpool, testkit )   <span class="co"># this is *linear* sRGB</span>
RGB</code></pre></div>
<pre><code>##                R         G         B
## pH=6.8 0.9871174 0.6566501 0.2169797
## pH=7   0.9827743 0.5700514 0.2406419
## pH=7.2 0.9775652 0.4762877 0.2677396
## pH=7.4 0.9719874 0.3861913 0.2976384
## pH=7.6 0.9664736 0.3067950 0.3302635
## pH=7.8 0.9613658 0.2405320 0.3660432
## pH=8   0.9570273 0.1869799 0.4056764
## pH=8.2 0.9537803 0.1443713 0.4496368</code></pre>
<p>All values have been multiplied by <code>bglin</code>, and are now OK. Draw the RGB patches on a white background multiplied by the same amount.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.RGB =<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">LEFT=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RGB), <span class="dt">TOP=</span><span class="dv">0</span>, <span class="dt">WIDTH=</span><span class="dv">1</span>, <span class="dt">HEIGHT=</span><span class="dv">2</span> )
df.RGB<span class="op">$</span>RGB =<span class="st"> </span>RGB
<span class="kw">par</span>( <span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="dv">0</span>) )
<span class="kw">plotPatchesRGB</span>( df.RGB, <span class="dt">space=</span><span class="st">'sRGB'</span>, <span class="dt">which=</span><span class="st">'scene'</span>, <span class="dt">labels=</span>F, <span class="dt">background=</span>bglin )
<span class="kw">text</span>( (<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RGB)) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">2</span>, <span class="kw">sprintf</span>(<span class="st">&quot;%.1f&quot;</span>,pHvec), <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>), <span class="dt">xpd=</span><span class="ot">NA</span> )
<span class="kw">title</span>( <span class="dt">main=</span><span class="st">'Calculated Colors for pH from 6.8 to 8.2'</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The background color is that of pure water, and is not the full RGB=(255,255,255).</p>
<p>In the first figure above, the phenol red concentration and optical path length are unknown. Compared to a real test kit, the calculated colors look a little faded. An absorbance multiplier can easily tweak the unknown concentration, as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tweak =<span class="st"> </span><span class="fl">1.3</span>
phenolpool =<span class="st"> </span><span class="kw">multiply</span>( phenolpool, tweak )
df.RGB =<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">LEFT=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RGB), <span class="dt">TOP=</span><span class="dv">0</span>, <span class="dt">WIDTH=</span><span class="dv">1</span>, <span class="dt">HEIGHT=</span><span class="dv">2</span> )
df.RGB<span class="op">$</span>RGB =<span class="st"> </span><span class="kw">product</span>( phenolpool, testkit ) <span class="co"># this is *linear scene* sRGB</span>
<span class="kw">par</span>( <span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="dv">0</span>) )
<span class="kw">plotPatchesRGB</span>( df.RGB, <span class="dt">space=</span><span class="st">'sRGB'</span>, <span class="dt">which=</span><span class="st">'scene'</span>, <span class="dt">background=</span>bglin, <span class="dt">labels=</span>F )
<span class="kw">text</span>( (<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RGB)) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">2</span>, <span class="kw">sprintf</span>(<span class="st">&quot;%.1f&quot;</span>,pHvec), <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>), <span class="dt">xpd=</span><span class="ot">NA</span> )
main =<span class="st"> </span><span class="kw">sprintf</span>( <span class="st">'Calculated Colors for pH from 6.8 to 8.2 (absorbance multiplier=%g)'</span>, tweak )
<span class="kw">title</span>( <span class="dt">main=</span>main )</code></pre></div>
<p><img src="data:image/png;base64,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TUaOAI13JN7YVh2V5kF9raU28djMvlekY4p/FjK3/3oonRayKHVTZcEAqsqli1EMM6/nFtIfwm5vcpnIk/zeQssA6lIRXDl9Uf/b0S/3VfWFmu4cxj6ILs7ly+OdqOXCwT6sfhWALmtJ/Vvpj6GLcznd2eEB9ONozL6m/5i6OJdDy3+3+83o1wHo0f+c/Vi6NpeN/2EZod6S3g4gVJP0dgChmqS3AwjVJL0dQKgm6e0AQjVJbwcQqkl6O4BQTdLbAYRqkt4OIFST9HYAoZqktwMI1SS9HUCoJuntAEI1SW8HEKpJejuAUE1y9OA/l+rfl+pfl+qfV+ofl+rvl+pvl+qvlwpAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRAARRA/38ARegjSHo7gFBN0tsBhGqS3g4gVJP0dgChmuRct5dHkYfwxygit/MuTOJ0i39+9+NV1l6/LL8+XebbouHzzxcZMzlsttZYhMxAYxGstaYiyKle01Klb88+u+MSytSWnDlZm1ZrbclJ1l6/LJbGFgyMb/NaufOAWmMmh83WmotgDDQXQVtrK4Kc6fT6ZZ0P46ev7o916KEx096YN32VtZfHm/qr1dq8AtEKqA30Kteai2AMNBfBWGsrgpzp9PK9mlyXAPry+BR+uQCpaM2pcUHW1sbPv28DNAX6feMuYaxdC2hzEQrunC2CnOk0ffrpOZ0qrtjih5AMV7epDdDBdh8us7Z413AGNcZsDptdu3SLby/C3p2zRZBTw8sympslq5pP1MvOGSrlJlrbmpesOZNtGChr69bXBmgyluWw1bX2IigDFxQhd+d0EeRMp/E7PcPWuZFtqu9VysUVgE5ZatpOH8rauMDZBmgyZnPY7FpzEbSB9iLk7pwvgpzp5E4n7qRyyakxVf2KLd4w1Lh+7nxrAzT1Njlsd621CMZAcxFydxqKIGc6Odf9Mf+CNU9tVRfgbnb4sZVPZW3cXYo2GDM5bLfWWgRjoLkImTstRZAznb49rwH4GeaiaVrz1DpywTWTXpXG1vvZ3RrXtIIqYyaHzdaai2AMNBfButNUBDnVaz2MuSjmK86geua3X9Sr3o1H48zapiZAtTGTw2Zrl55B24ugrbUVQc51m9yXV/6+q+3rxOzKf2z+li1Z85ty03ci2re5EVBjbLo0bc1FGHRJm4ugrLUVQVq8QOiXlvR2AKGapLcDCNUkvR1AqCbp7QBCNUlvBxCqSXo7gFBN0tsBhGqS3g4gVJP0dgChmqS3AwjVJL0dQKgm6e0AQjVJbwcQqkl6O4BQTdLbAYRqkt4OIFST9HYAoZqktwMI1SS9HUCoJuntAEI1SW8HEKpJejuAUE3S2wGEapLeDiBUk/R2AKGa/gvdsDjFqFt4BAAAAABJRU5ErkJggg==" /><!-- --> These colors are a better match to those in the test kit.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<div id="refs">
<div id="ref-Rovati">
<p>[1] LUIGI ROVATI, Luca Ferrari, Paola Fabbri and PILATI, Francesco. Plastic Optical Fiber pH Sensor Using a Sol-Gel Sensing Matrix. In: MOH. YASIN Sulaiman W. Harun and Hamzah AROF, eds. <em>Fiber Optic Sensors</em> [online]. B.m.: InTech, 2012. Available at: doi:<a href="https://doi.org/10.5772/26517">10.5772/26517</a></p>
</div>
<div id="ref-K-1000">
<p>[2] TAYLOR TECHNOLOGIES, Inc. <em>K-1000 sureCHECK Safety Test, Bromine &amp; Chlorine (hi range), OT/pH</em> [online]. 2017. Available at: <a href="https://www.taylortechnologies.com/en/product/test-kits/surecheck-safety-test-bromine-chlorine-hi-range-otph--K-1000" class="uri">https://www.taylortechnologies.com/en/product/test-kits/surecheck-safety-test-bromine-chlorine-hi-range-otph--K-1000</a></p>
</div>
<div id="ref-wiki:pH">
<p>[3] WIKIPEDIA. <em>pH indicator — Wikipedia, The Free Encyclopedia</em> [online]. 2017. Available at: <a href="https://en.wikipedia.org/w/index.php?title=PH_indicator" class="uri">https://en.wikipedia.org/w/index.php?title=PH_indicator</a>. [Online; accessed 10-November-2017]</p>
</div>
<div id="ref-wiki:sRGB">
<p>[4] WIKIPEDIA. <em>SRGB — wikipedia, the free encyclopedia</em> [online]. 2017. Available at: <a href="https://en.wikipedia.org/w/index.php?title=SRGB" class="uri">https://en.wikipedia.org/w/index.php?title=SRGB</a>. [Online; accessed 13-November-2017]</p>
</div>
</div>
<p><br><br></p>
</div>
<div id="session-information" class="section level2">
<h2>Session Information</h2>
<pre>
R version 3.6.0 (2019-04-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

Matrix products: default

locale:
[1] LC_COLLATE=C                          
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] spacesRGB_1.2-2 colorSpec_0.9-1

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.1           digest_0.6.18        spacesXYZ_1.0-4     
 [4] MASS_7.3-51.4        magrittr_1.5         evaluate_0.13       
 [7] stringi_1.4.3        rmarkdown_1.12       tools_3.6.0         
[10] stringr_1.4.0        xfun_0.7             yaml_2.2.0          
[13] compiler_3.6.0       microbenchmark_1.4-6 htmltools_0.3.6     
[16] knitr_1.22          
</pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
